# -----------------------------------------------
# Path setup
# -----------------------------------------------
IP_ROOT := ..

# -----------------------------------------------
# IP config
# -----------------------------------------------
include $(IP_ROOT)/config.mk

# -----------------------------------------------
# Regmap YAML sources
#   List regio yaml block and decoder specification sources.
#   RTL is autogenerated for all yaml files listed.
# -----------------------------------------------
REG_BLOCK_YAML = smartnic_322mhz.yaml
REG_DECODER_YAML = smartnic_322mhz_app_decoder.yaml \
                   smartnic_322mhz_app_sdnet_decoder.yaml \
                   xilinx_hbm_0_decoder.yaml \
                   xilinx_hbm_1_decoder.yaml \
                   smartnic_322mhz_decoder.yaml

# ----------------------------------------------------
# Sources
#   List source files and include directories for component.
#   (see $(SCRIPTS_ROOT)/Makefiles/sources.mk)
#   Note: if no sources are explicitly listed, all
#   source files from ./src are added automatically,
#   with include directory ./include
# ----------------------------------------------------
SRC_FILES =
INC_DIRS =
SRC_LIST_FILES =

# ----------------------------------------------------
# Dependencies
#   List IP component and external library dependencies
#   (see $SCRIPTS_ROOT/Makefiles/dependencies.mk)
# ----------------------------------------------------
COMPONENTS = reg_rtl=$(LIB_ROOT)/src/reg/rtl \
             mem_rtl=$(LIB_ROOT)/src/mem/rtl
EXT_LIBS =

# ----------------------------------------------------
# Defines
#   List macro definitions.
# ----------------------------------------------------
DEFINES =

# ----------------------------------------------------
# Options
# ----------------------------------------------------
COMPILE_OPTS=
ELAB_OPTS=--debug typical
SIM_OPTS=

REGIO_ELABORATE_OPTS :=
REGIO_GENERATE_OPTS :=

# ----------------------------------------------------
# Targets
# ----------------------------------------------------
all: compile

cp_app_dec:
	@cp $(IP_ROOT)/app_if/smartnic_322mhz_app_decoder.yaml $(IP_ROOT)/reg

reg: cp_app_dec
	$(MAKE) _reg

compile: reg
	$(MAKE) _compile

clean: _clean_reg _clean_compile
	@rm -f smartnic_322mhz_app_decoder.yaml

.PHONY: all cp_app_dec reg compile clean

# -----------------------------------------------
# Include regio targets
# -----------------------------------------------
include $(SCRIPTS_ROOT)/Makefiles/regio.mk

# ----------------------------------------------------
# Import Vivado compile targets
# ----------------------------------------------------
include $(SCRIPTS_ROOT)/Makefiles/vivado_compile.mk
